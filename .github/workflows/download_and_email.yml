name: 'æ‰‹åŠ¨å‘é€é‚®ä»¶æ¶ˆæ¯'

# é…ç½®æ‰‹åŠ¨è§¦å‘ï¼Œå¹¶å®šä¹‰æ–°çš„ä¸‰ä¸ªè¾“å…¥æ¡†
on:
  workflow_dispatch:
    inputs:
      email_subject:
        description: 'ğŸ“ é‚®ä»¶ä¸»é¢˜ (å¯¹è¯å½¢å¼)'
        required: true
        default: 'æ¥è‡ª GitHub Actions çš„é€šçŸ¥'
      email_body:
        description: 'ğŸ’¬ é‚®ä»¶å†…å®¹ (è¾“å…¥å†…å®¹)'
        required: true
        default: 'è¿™æ˜¯ä¸€æ¡é€šè¿‡ GitHub Actions å‘é€çš„æµ‹è¯•æ¶ˆæ¯ã€‚'
      recipient_email:
        description: 'ğŸ“§ æ”¶ä»¶äººé‚®ç®±åœ°å€ (æ”¶ä»¶äºº)'
        required: true
        default: '275559292@qq.com' 

jobs:
  send_message:
    name: 'å‘é€é‚®ä»¶ä»»åŠ¡'
    runs-on: ubuntu-latest

    steps:
      # æ­¥éª¤ 1: æ‰“å°è¾“å…¥ä¿¡æ¯ (å¯é€‰ï¼Œç”¨äºè°ƒè¯•)
      - name: 1. æ£€æŸ¥å¹¶ç¡®è®¤è¾“å…¥ä¿¡æ¯
        run: |
          echo "ç›®æ ‡é‚®ç®±: ${{ github.event.inputs.recipient_email }}"
          echo "é‚®ä»¶ä¸»é¢˜: ${{ github.event.inputs.email_subject }}"
          echo "é‚®ä»¶æ­£æ–‡ï¼ˆå‰50å­—ç¬¦ï¼‰: ${{ github.event.inputs.email_body }}"

      # æ­¥éª¤ 2: å‘é€é‚®ä»¶
      - name: 2. å‘é€æ¶ˆæ¯é‚®ä»¶
        uses: dawidd6/action-send-mail@v3
        with:
          # SMTP æœåŠ¡å™¨é…ç½® (å¿…é¡»ä½¿ç”¨ Secrets)
          server_address: ${{ secrets.SMTP_HOST }}
          server_port: ${{ secrets.SMTP_PORT }}
          username: ${{ secrets.SMTP_USERNAME }}
          password: ${{ secrets.SMTP_PASSWORD }} 

          # é‚®ä»¶å†…å®¹é…ç½®
          # ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„â€œå¯¹è¯å½¢å¼â€ä½œä¸ºä¸»é¢˜
          subject: ${{ github.event.inputs.email_subject }}
          
          # ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„â€œæ”¶ä»¶äººâ€é‚®ç®±
          to: ${{ github.event.inputs.recipient_email }}
          
          # å‘ä»¶äºº
          from: GitHub Actions <${{ secrets.SMTP_USERNAME }}> 
          
          # ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„â€œè¾“å…¥å†…å®¹â€ä½œä¸ºæ­£æ–‡
          body: ${{ github.event.inputs.email_body }}
          
          # æ ¼å¼åŒ–æ­£æ–‡ä¸º HTML æˆ–çº¯æ–‡æœ¬
          content_type: text/plain
